{"is_source_file": true, "format": "Python", "description": "This file implements a minimal token-based authentication system using HMAC, including token creation and decoding with validation. It uses environment variables for secret management and defines a TokenPayload dataclass.", "external_files": ["os", "hmac", "hashlib", "time"], "external_methods": ["os.getenv", "hmac.new", "hmac.compare_digest"], "published": ["create_token", "decode_token"], "classes": [{"name": "TokenPayload", "description": "Dataclass representing the payload of a token with subject and expiry fields."}], "methods": [{"name": "str create_token(sub: str)", "description": "Creates a signed token for a given subject with an expiry timestamp (default 24 hours).", "scope": "", "scopeKind": ""}, {"name": "TokenPayload decode_token(token: str)", "description": "Decodes and validates a token, raises ValueError if invalid or expired, and returns a TokenPayload instance.", "scope": "", "scopeKind": ""}, {"name": "str _secret()", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["os.getenv", "hmac.new", "hmac.compare_digest", "time.time"], "search-terms": ["HMAC token", "JWT substitute", "security", "token creation", "token decoding", "dataclass security"], "state": 2, "file_id": 12, "knowledge_revision": 26, "git_revision": "", "ctags": [{"_type": "tag", "name": "DEFAULT_SECRET", "path": "/home/kavia/workspace/code-generation/music-video-preview-player-22936-22945/music_player_backend/src/api/core/security.py", "pattern": "/^DEFAULT_SECRET = \"dev-secret-change-me\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "TOKEN_TTL_SECONDS", "path": "/home/kavia/workspace/code-generation/music-video-preview-player-22936-22945/music_player_backend/src/api/core/security.py", "pattern": "/^TOKEN_TTL_SECONDS = 60 * 60 * 24  # 24 hours$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "TokenPayload", "path": "/home/kavia/workspace/code-generation/music-video-preview-player-22936-22945/music_player_backend/src/api/core/security.py", "pattern": "/^class TokenPayload:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_secret", "path": "/home/kavia/workspace/code-generation/music-video-preview-player-22936-22945/music_player_backend/src/api/core/security.py", "pattern": "/^def _secret() -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "create_token", "path": "/home/kavia/workspace/code-generation/music-video-preview-player-22936-22945/music_player_backend/src/api/core/security.py", "pattern": "/^def create_token(sub: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(sub: str)"}, {"_type": "tag", "name": "decode_token", "path": "/home/kavia/workspace/code-generation/music-video-preview-player-22936-22945/music_player_backend/src/api/core/security.py", "pattern": "/^def decode_token(token: str) -> TokenPayload:$/", "language": "Python", "typeref": "typename:TokenPayload", "kind": "function", "signature": "(token: str)"}], "hash": "00d88bbf218cb36b6f21c820c2596ff4", "format-version": 4, "code-base-name": "music_player_backend", "filename": "music_player_backend/src/api/core/security.py", "fields": [{"name": "DEFAULT_SECRET = \"dev-secret-change-me\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "TOKEN_TTL_SECONDS = 60 * 60 * 24  # 24 hours", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"26": ""}]}